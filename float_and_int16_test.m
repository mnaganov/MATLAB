syst = 'octave';
path_pfx = ['/Users/mikhail/Sounds/Dithering/' syst '-'];
fs = 8000;

% Step 1. Determine Int16 unit size
if strcmp(syst, 'matlab')
  max_pos = 32767.0;
  min_neg = -32768.0;
elseif strcmp(syst, 'octave')
  max_pos = 32767.0;
  min_neg = -32767.0;
else % audacity
  max_pos = 32767.0;
  min_neg = -32768.0;
end
n_unit = 1.0 / (-min_neg);
p_unit = 1.0 / max_pos;

% Step 2. Check rounding
float_wave = [-1.0, ...
              -1.0 + n_unit * 0.25, -1.0 + n_unit * 0.75, ...
              -1.0 + n_unit, -1.0 + n_unit * 2.0, ...
              0.0 - n_unit * 2.0, 0.0 - n_unit * 1.75, 0.0 - n_unit * 1.25, ...
              0.0 - n_unit, ...
              0.0 - n_unit * 0.75, 0.0 - n_unit * 0.25, ...
              0.0, ...
              0.0 + p_unit * 0.25, 0.0 + p_unit * 0.75, ...
              p_unit, p_unit * 1.25, p_unit * 1.75, p_unit * 2.0, ...
              1.0 - p_unit * 2.0, ...
              1.0 - p_unit, ...
              1.0 - p_unit * 0.75, 1.0 - p_unit * 0.25, ...
              1.0];
bps32_file = [path_pfx 'bps32.wav'];
audiowrite(bps32_file, float_wave, fs, 'BitsPerSample', 32);
int16_file = [path_pfx 'int16.wav'];
audiowrite(int16_file, float_wave, fs, 'BitsPerSample', 16);
